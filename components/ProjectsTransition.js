import React, { useRef, useEffect } from "react";
import styles from "@/styles/modules/project_transition.module.css";
import { gsap } from "gsap";
import { ScrollTrigger } from "gsap/dist/ScrollTrigger";
import { motion } from "framer-motion";
import { useGlobal } from "@/context/GlobalContext";

export default function ProjectsTransition() {
  const trigger = useRef(null);
  const dots = useRef(null);
  const title = useRef(null);
  const down = useRef(null);
  const { device } = useGlobal();

  gsap.registerPlugin(ScrollTrigger);

  useEffect(() => {
    const context = gsap.context(() => {
      gsap
        .timeline({
          scrollTrigger: {
            trigger: trigger.current,
            start: "top 75%",
            end: "bottom 75%",
            toggleActions: "play reverse play reverse",
          },
        })
        .from(dots.current, {
          opacity: 0,
          scale: 0,
          duration: 0.2,
        })
        .from(title.current, {
          opacity: 0,
          scale: 0,
          duration: 0.2,
        })
        .from(down.current, {
          opacity: 0,
          scale: 0,
          duration: 0.2,
        });
    });

    return () => context.revert();
  }, []);

  return (
    <div>
      {!device && (
        <div className={styles.transition_container} ref={trigger}>
          <div className={styles.transition}>
            <div className={styles.dots} ref={dots}>
              <div className={styles.dots_center}></div>
              <div className={styles.dots_left}></div>
              <div className={styles.dots_right}></div>
            </div>
            <div className={styles.title} ref={title}>
              <svg
                width="789"
                height="229"
                viewBox="0 0 789 229"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M129.756 21.856V36.576H158.556V55.648H129.756V71.904H162.396V92H104.668V1.75999H162.396V21.856H129.756Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M231.241 92L213.705 66.528L198.729 92H170.185L199.497 45.792L169.161 1.75999H198.729L215.753 26.592L230.345 1.75999H258.889L229.961 47.2L260.809 92H231.241Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M340.714 31.84C340.714 37.3013 339.434 42.2933 336.874 46.816C334.399 51.2533 330.602 54.8373 325.482 57.568C320.447 60.2133 314.261 61.536 306.922 61.536H294.506V92H269.418V1.75999H306.922C314.175 1.75999 320.319 3.03999 325.354 5.59999C330.474 8.15999 334.314 11.7013 336.874 16.224C339.434 20.7467 340.714 25.952 340.714 31.84ZM304.49 41.568C311.573 41.568 315.114 38.3253 315.114 31.84C315.114 25.2693 311.573 21.984 304.49 21.984H294.506V41.568H304.49Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M375.881 72.8H403.913V92H350.793V1.75999H375.881V72.8Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M456.932 92.896C448.484 92.896 440.719 90.9333 433.636 87.008C426.553 82.9973 420.921 77.4933 416.74 70.496C412.644 63.4133 410.596 55.4347 410.596 46.56C410.596 37.6853 412.644 29.7493 416.74 22.752C420.921 15.6693 426.553 10.1653 433.636 6.23999C440.719 2.31466 448.484 0.35199 456.932 0.35199C465.465 0.35199 473.231 2.31466 480.228 6.23999C487.311 10.1653 492.9 15.6693 496.996 22.752C501.092 29.7493 503.14 37.6853 503.14 46.56C503.14 55.4347 501.092 63.4133 496.996 70.496C492.9 77.4933 487.311 82.9973 480.228 87.008C473.145 90.9333 465.38 92.896 456.932 92.896ZM456.932 69.6C463.332 69.6 468.367 67.5093 472.036 63.328C475.791 59.1467 477.668 53.5573 477.668 46.56C477.668 39.392 475.791 33.76 472.036 29.664C468.367 25.4827 463.332 23.392 456.932 23.392C450.447 23.392 445.369 25.4827 441.7 29.664C438.031 33.76 436.196 39.392 436.196 46.56C436.196 53.6427 438.031 59.2747 441.7 63.456C445.369 67.552 450.447 69.6 456.932 69.6Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M560.114 92L542.194 58.72H539.506V92H514.418V1.75999H553.97C561.223 1.75999 567.367 3.03999 572.402 5.59999C577.437 8.07466 581.234 11.5307 583.794 15.968C586.354 20.32 587.634 25.2267 587.634 30.688C587.634 36.832 585.927 42.2507 582.514 46.944C579.186 51.552 574.279 54.8373 567.794 56.8L588.146 92H560.114ZM539.506 41.568H551.922C555.335 41.568 557.895 40.7573 559.602 39.136C561.309 37.5147 562.162 35.168 562.162 32.096C562.162 29.1947 561.266 26.9333 559.474 25.312C557.767 23.6053 555.25 22.752 551.922 22.752H539.506V41.568Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M656.131 77.28H624.131L619.267 92H592.899L625.795 1.75999H654.723L687.491 92H660.995L656.131 77.28ZM649.859 58.08L640.131 28.896L630.531 58.08H649.859Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M105.512 137.76V228H80.424V178.208L63.4 228H42.408L25.256 177.824V228H0.167969V137.76H30.504L53.16 196.384L75.304 137.76H105.512Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M144.881 137.76V228H119.793V137.76H144.881Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M251.636 137.76V157.728H227.572V228H202.484V157.728H178.676V137.76H251.636Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M306.614 228L288.694 194.72H286.006V228H260.918V137.76H300.47C307.723 137.76 313.867 139.04 318.902 141.6C323.937 144.075 327.734 147.531 330.294 151.968C332.854 156.32 334.134 161.227 334.134 166.688C334.134 172.832 332.427 178.251 329.014 182.944C325.686 187.552 320.779 190.837 314.294 192.8L334.646 228H306.614ZM286.006 177.568H298.422C301.835 177.568 304.395 176.757 306.102 175.136C307.809 173.515 308.662 171.168 308.662 168.096C308.662 165.195 307.766 162.933 305.974 161.312C304.267 159.605 301.75 158.752 298.422 158.752H286.006V177.568Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M402.631 213.28H370.631L365.767 228H339.399L372.295 137.76H401.223L433.991 228H407.495L402.631 213.28ZM396.359 194.08L386.631 164.896L377.031 194.08H396.359Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M499.768 181.664C505.059 182.859 509.24 185.504 512.312 189.6C515.469 193.611 517.048 198.219 517.048 203.424C517.048 211.104 514.403 217.12 509.112 221.472C503.821 225.824 496.397 228 486.84 228H442.168V137.76H485.432C494.648 137.76 501.859 139.808 507.064 143.904C512.355 148 515 153.76 515 161.184C515 166.475 513.592 170.912 510.776 174.496C508.045 177.995 504.376 180.384 499.768 181.664ZM467.256 173.6H479.928C486.243 173.6 489.4 170.997 489.4 165.792C489.4 160.416 486.243 157.728 479.928 157.728H467.256V173.6ZM481.848 207.776C488.163 207.776 491.32 205.131 491.32 199.84C491.32 197.109 490.467 195.019 488.76 193.568C487.139 192.117 484.792 191.392 481.72 191.392H467.256V207.776H481.848Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M585.131 213.28H553.131L548.267 228H521.899L554.795 137.76H583.723L616.491 228H589.995L585.131 213.28ZM578.859 194.08L569.131 164.896L559.531 194.08H578.859Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M684.444 137.76V197.536C684.444 207.691 681.671 215.456 676.124 220.832C670.663 226.208 663.111 228.896 653.468 228.896C643.228 228.896 635.036 226.037 628.892 220.32C622.833 214.603 619.804 206.368 619.804 195.616H644.636C644.721 202.699 647.324 206.24 652.444 206.24C657.052 206.24 659.356 203.339 659.356 197.536V137.76H684.444Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M742.682 228.896C734.234 228.896 726.469 226.933 719.386 223.008C712.303 218.997 706.671 213.493 702.49 206.496C698.394 199.413 696.346 191.435 696.346 182.56C696.346 173.685 698.394 165.749 702.49 158.752C706.671 151.669 712.303 146.165 719.386 142.24C726.469 138.315 734.234 136.352 742.682 136.352C751.215 136.352 758.981 138.315 765.978 142.24C773.061 146.165 778.65 151.669 782.746 158.752C786.842 165.749 788.89 173.685 788.89 182.56C788.89 191.435 786.842 199.413 782.746 206.496C778.65 213.493 773.061 218.997 765.978 223.008C758.895 226.933 751.13 228.896 742.682 228.896ZM742.682 205.6C749.082 205.6 754.117 203.509 757.786 199.328C761.541 195.147 763.418 189.557 763.418 182.56C763.418 175.392 761.541 169.76 757.786 165.664C754.117 161.483 749.082 159.392 742.682 159.392C736.197 159.392 731.119 161.483 727.45 165.664C723.781 169.76 721.946 175.392 721.946 182.56C721.946 189.643 723.781 195.275 727.45 199.456C731.119 203.552 736.197 205.6 742.682 205.6Z"
                  fill="var(--white-main)"
                />
              </svg>
            </div>
            <div className={styles.triangle} ref={down}>
              <svg
                width="89"
                height="75"
                viewBox="0 0 89 75"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M30.7312 52.4319L43.9723 75L57.2134 52.5291H48.2214L43.9723 59.7276L39.6245 52.4319L44.0712 44.9416H61.5613L65.9091 37.4513H48.3202L57.2134 22.4708H65.9091L61.6601 29.8638H70.4546L79.249 14.8832H52.668L30.7312 52.4319Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M26.3834 44.8444L0 0H44.0217H88.0435L83.6957 7.49027H13.2411L17.6877 14.9805H44.0711L35.1779 30.0584L30.7312 22.4708H22.0356L30.83 37.4514L26.3834 44.8444Z"
                  fill="var(--white-main)"
                />
              </svg>
            </div>
          </div>
        </div>
      )}
      {device && (
        <div className={styles.transition_container}>
          <div className={styles.transition}>
            <motion.div
              className={styles.dots}
              initial={{ opacity: 0, scale: 0 }}
              whileInView={{ opacity: 1, scale: 1 }}
              viewport={false}
              transition={{
                duration: 0.5,
                delay: 0.25,
              }}
            >
              <div className={styles.dots_center}></div>
              <div className={styles.dots_left}></div>
              <div className={styles.dots_right}></div>
            </motion.div>
            <motion.div
              className={styles.title}
              initial={{ opacity: 0, scale: 0 }}
              whileInView={{ opacity: 1, scale: 1 }}
              viewport={false}
              transition={{
                duration: 0.5,
                delay: 0.25,
              }}
            >
              <svg
                width="789"
                height="229"
                viewBox="0 0 789 229"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M129.756 21.856V36.576H158.556V55.648H129.756V71.904H162.396V92H104.668V1.75999H162.396V21.856H129.756Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M231.241 92L213.705 66.528L198.729 92H170.185L199.497 45.792L169.161 1.75999H198.729L215.753 26.592L230.345 1.75999H258.889L229.961 47.2L260.809 92H231.241Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M340.714 31.84C340.714 37.3013 339.434 42.2933 336.874 46.816C334.399 51.2533 330.602 54.8373 325.482 57.568C320.447 60.2133 314.261 61.536 306.922 61.536H294.506V92H269.418V1.75999H306.922C314.175 1.75999 320.319 3.03999 325.354 5.59999C330.474 8.15999 334.314 11.7013 336.874 16.224C339.434 20.7467 340.714 25.952 340.714 31.84ZM304.49 41.568C311.573 41.568 315.114 38.3253 315.114 31.84C315.114 25.2693 311.573 21.984 304.49 21.984H294.506V41.568H304.49Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M375.881 72.8H403.913V92H350.793V1.75999H375.881V72.8Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M456.932 92.896C448.484 92.896 440.719 90.9333 433.636 87.008C426.553 82.9973 420.921 77.4933 416.74 70.496C412.644 63.4133 410.596 55.4347 410.596 46.56C410.596 37.6853 412.644 29.7493 416.74 22.752C420.921 15.6693 426.553 10.1653 433.636 6.23999C440.719 2.31466 448.484 0.35199 456.932 0.35199C465.465 0.35199 473.231 2.31466 480.228 6.23999C487.311 10.1653 492.9 15.6693 496.996 22.752C501.092 29.7493 503.14 37.6853 503.14 46.56C503.14 55.4347 501.092 63.4133 496.996 70.496C492.9 77.4933 487.311 82.9973 480.228 87.008C473.145 90.9333 465.38 92.896 456.932 92.896ZM456.932 69.6C463.332 69.6 468.367 67.5093 472.036 63.328C475.791 59.1467 477.668 53.5573 477.668 46.56C477.668 39.392 475.791 33.76 472.036 29.664C468.367 25.4827 463.332 23.392 456.932 23.392C450.447 23.392 445.369 25.4827 441.7 29.664C438.031 33.76 436.196 39.392 436.196 46.56C436.196 53.6427 438.031 59.2747 441.7 63.456C445.369 67.552 450.447 69.6 456.932 69.6Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M560.114 92L542.194 58.72H539.506V92H514.418V1.75999H553.97C561.223 1.75999 567.367 3.03999 572.402 5.59999C577.437 8.07466 581.234 11.5307 583.794 15.968C586.354 20.32 587.634 25.2267 587.634 30.688C587.634 36.832 585.927 42.2507 582.514 46.944C579.186 51.552 574.279 54.8373 567.794 56.8L588.146 92H560.114ZM539.506 41.568H551.922C555.335 41.568 557.895 40.7573 559.602 39.136C561.309 37.5147 562.162 35.168 562.162 32.096C562.162 29.1947 561.266 26.9333 559.474 25.312C557.767 23.6053 555.25 22.752 551.922 22.752H539.506V41.568Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M656.131 77.28H624.131L619.267 92H592.899L625.795 1.75999H654.723L687.491 92H660.995L656.131 77.28ZM649.859 58.08L640.131 28.896L630.531 58.08H649.859Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M105.512 137.76V228H80.424V178.208L63.4 228H42.408L25.256 177.824V228H0.167969V137.76H30.504L53.16 196.384L75.304 137.76H105.512Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M144.881 137.76V228H119.793V137.76H144.881Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M251.636 137.76V157.728H227.572V228H202.484V157.728H178.676V137.76H251.636Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M306.614 228L288.694 194.72H286.006V228H260.918V137.76H300.47C307.723 137.76 313.867 139.04 318.902 141.6C323.937 144.075 327.734 147.531 330.294 151.968C332.854 156.32 334.134 161.227 334.134 166.688C334.134 172.832 332.427 178.251 329.014 182.944C325.686 187.552 320.779 190.837 314.294 192.8L334.646 228H306.614ZM286.006 177.568H298.422C301.835 177.568 304.395 176.757 306.102 175.136C307.809 173.515 308.662 171.168 308.662 168.096C308.662 165.195 307.766 162.933 305.974 161.312C304.267 159.605 301.75 158.752 298.422 158.752H286.006V177.568Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M402.631 213.28H370.631L365.767 228H339.399L372.295 137.76H401.223L433.991 228H407.495L402.631 213.28ZM396.359 194.08L386.631 164.896L377.031 194.08H396.359Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M499.768 181.664C505.059 182.859 509.24 185.504 512.312 189.6C515.469 193.611 517.048 198.219 517.048 203.424C517.048 211.104 514.403 217.12 509.112 221.472C503.821 225.824 496.397 228 486.84 228H442.168V137.76H485.432C494.648 137.76 501.859 139.808 507.064 143.904C512.355 148 515 153.76 515 161.184C515 166.475 513.592 170.912 510.776 174.496C508.045 177.995 504.376 180.384 499.768 181.664ZM467.256 173.6H479.928C486.243 173.6 489.4 170.997 489.4 165.792C489.4 160.416 486.243 157.728 479.928 157.728H467.256V173.6ZM481.848 207.776C488.163 207.776 491.32 205.131 491.32 199.84C491.32 197.109 490.467 195.019 488.76 193.568C487.139 192.117 484.792 191.392 481.72 191.392H467.256V207.776H481.848Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M585.131 213.28H553.131L548.267 228H521.899L554.795 137.76H583.723L616.491 228H589.995L585.131 213.28ZM578.859 194.08L569.131 164.896L559.531 194.08H578.859Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M684.444 137.76V197.536C684.444 207.691 681.671 215.456 676.124 220.832C670.663 226.208 663.111 228.896 653.468 228.896C643.228 228.896 635.036 226.037 628.892 220.32C622.833 214.603 619.804 206.368 619.804 195.616H644.636C644.721 202.699 647.324 206.24 652.444 206.24C657.052 206.24 659.356 203.339 659.356 197.536V137.76H684.444Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M742.682 228.896C734.234 228.896 726.469 226.933 719.386 223.008C712.303 218.997 706.671 213.493 702.49 206.496C698.394 199.413 696.346 191.435 696.346 182.56C696.346 173.685 698.394 165.749 702.49 158.752C706.671 151.669 712.303 146.165 719.386 142.24C726.469 138.315 734.234 136.352 742.682 136.352C751.215 136.352 758.981 138.315 765.978 142.24C773.061 146.165 778.65 151.669 782.746 158.752C786.842 165.749 788.89 173.685 788.89 182.56C788.89 191.435 786.842 199.413 782.746 206.496C778.65 213.493 773.061 218.997 765.978 223.008C758.895 226.933 751.13 228.896 742.682 228.896ZM742.682 205.6C749.082 205.6 754.117 203.509 757.786 199.328C761.541 195.147 763.418 189.557 763.418 182.56C763.418 175.392 761.541 169.76 757.786 165.664C754.117 161.483 749.082 159.392 742.682 159.392C736.197 159.392 731.119 161.483 727.45 165.664C723.781 169.76 721.946 175.392 721.946 182.56C721.946 189.643 723.781 195.275 727.45 199.456C731.119 203.552 736.197 205.6 742.682 205.6Z"
                  fill="var(--white-main)"
                />
              </svg>
            </motion.div>
            <motion.div
              className={styles.triangle}
              initial={{ opacity: 0, scale: 0 }}
              whileInView={{ opacity: 1, scale: 1 }}
              viewport={false}
              transition={{
                duration: 0.5,
                delay: 0.25,
              }}
            >
              <svg
                width="89"
                height="75"
                viewBox="0 0 89 75"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M30.7312 52.4319L43.9723 75L57.2134 52.5291H48.2214L43.9723 59.7276L39.6245 52.4319L44.0712 44.9416H61.5613L65.9091 37.4513H48.3202L57.2134 22.4708H65.9091L61.6601 29.8638H70.4546L79.249 14.8832H52.668L30.7312 52.4319Z"
                  fill="var(--white-main)"
                />
                <path
                  d="M26.3834 44.8444L0 0H44.0217H88.0435L83.6957 7.49027H13.2411L17.6877 14.9805H44.0711L35.1779 30.0584L30.7312 22.4708H22.0356L30.83 37.4514L26.3834 44.8444Z"
                  fill="var(--white-main)"
                />
              </svg>
            </motion.div>
          </div>
        </div>
      )}
    </div>
  );
}
